import com.rameses.annotations.*;

class WaterworksPaymentService {

	@Service("DateService")
	def dateSvc;

	@Service("WaterworksApplicationBillingPaymentService")
    def appBillPmtSvc;

    @Service("WaterworksCompromiseBillingPaymentService")
    def compBillPmtSvc;

    @Service("WaterworksRegularBillingPaymentService")
    def regBillSvc;

	@ProxyMethod 
	public def postPayment( def param ) {
		if( param.pmttxntype == "application" ) {
			appBillPmtSvc.postPayment( param );
		}
		else if( param.billid ) {
			regBillSvc.postPayment( param );
		}
		else {
			throw new Exception("Non bill payment not yet supported");
		}
	}

	@ProxyMethod 
	public def voidPayment( param ) {
		def refid = param.receipt?.objid;
		if( refid == null) refid = param.refid;

		if( pmt.pmttxntype == "application" ) {
			appBillPmtSvc.voidPayment( [pmtid: refid ] );	
		}
		else if( pmt.pmttxntype == "compromise") {
			compBillPmtSvc.voidPayment( [pmtid: refid ] );
		}
		else {
			regBillSvc.voidPayment( [pmtid: pmtid ] );
		}
	}


}